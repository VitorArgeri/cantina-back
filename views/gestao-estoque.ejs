<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>GestÃ£o de Estoque</title>
</head>

<body>
    <header>
        <h2>ğŸ“Š GestÃ£o de Estoque</h2>
        <nav>
            <a href="/dashboard">ğŸ  Dashboard</a> |
            <a href="/cadastro-produto">ğŸ“¦ Comidas</a> |
            <a href="/logout">ğŸšª Sair</a>
        </nav>
    </header>

    <main>
        <section>
            <h3>â• Registrar movimentaÃ§Ã£o</h3>
            <form action="/gestao-estoque" method="POST" class="form-mov">
                <select name="comida_id" required>
                    <option value="">-- Selecione a comida --</option>
                    <% comidas.forEach(comida => { %>
                        <option value="<%= comida.id %>">
                            <%= comida.nome %> (Estoque: <%= comida.estoque %>)
                        </option>
                    <% }) %>
                </select>

                <select name="type" required>
                    <option value="entrada">Entrada</option>
                    <option value="saida">SaÃ­da</option>
                </select>

                <input type="number" name="quantity" min="1" placeholder="Quantidade" required>
                <input type="date" name="movement_date" value="<%= new Date().toISOString().slice(0,10) %>" required>
                <input type="text" name="note" placeholder="ObservaÃ§Ã£o (opcional)">
                <button type="submit">Registrar</button>
            </form>
        </section>

        <section>
            <h3>ğŸ•“ Ãšltimas movimentaÃ§Ãµes</h3>
            <table border="1">
                <thead>
                    <tr>
                        <th>Comida</th>
                        <th>UsuÃ¡rio</th>
                        <th>Tipo</th>
                        <th>Qtd</th>
                        <th>Data</th>
                        <th>Saldo</th>
                        <th>ObservaÃ§Ã£o</th>
                    </tr>
                </thead>
                <tbody>
                    <% movimentos.forEach(m => { %>
                        <tr class="<%= m.type === 'saida' ? 'saida' : 'entrada' %>">
                            <td><%= m.comida %></td>
                            <td><%= m.usuario %></td>
                            <td><%= m.type %></td>
                            <td><%= m.quantity %></td>
                            <td><%= m.data %></td>
                            <td><%= m.balance_after %></td>
                            <td><%= m.note || '-' %></td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        </section>
    </main>
</body>

</html>
